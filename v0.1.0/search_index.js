var documenterSearchIndex = {"docs":
[{"location":"lib/public/#public-documentation-1","page":"public","title":"public documentation","text":"","category":"section"},{"location":"lib/public/#","page":"public","title":"public","text":"Documentation for QuartetNetworkGoodnessFit's public (exported) functions.","category":"page"},{"location":"lib/public/#index-1","page":"public","title":"index","text":"","category":"section"},{"location":"lib/public/#","page":"public","title":"public","text":"Pages = [\"public.md\"]","category":"page"},{"location":"lib/public/#functions-1","page":"public","title":"functions","text":"","category":"section"},{"location":"lib/public/#","page":"public","title":"public","text":"Modules = [QuartetNetworkGoodnessFit]\nPrivate = false\nOrder   = [:function]","category":"page"},{"location":"lib/public/#PhyloNetworks.ticr!-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool}","page":"public","title":"PhyloNetworks.ticr!","text":"ticr!(net::HybridNetwork, df::DataFrame, optbl::Bool; quartetstat, test)\nticr!(net::HybridNetwork, dcf::DataCF,   optbl::Bool; quartetstat, test)\nticr(dcf::DataCF, quartetstat::Symbol, test::Symbol)\n\nGoodness-of-fit test for the adequacy of the multispecies network coalescent, to see if a given population or species network explains the quartet concordance factor data adequately. See Stenz et al 2015 and addendum for the method on trees, from which the acronym TICR was derived: Tree Incongruence Checking with R.\n\nThe tree / network needs to have branch lengths in coalescent units, and must be of level 1. It must be fully resolved, such that the \"major\" quartet is clearly defined, even though branch lengths can be 0.\n\nThe Dirichlet distribution is used to fit the distribution of the observed quartet concordance factors (CF), with a concentration parameter estimated from the data.\n\nThe four-taxon sets are then binned into categories according to their outlier p-values: 0-0.01, 0.01-0.05, 0.05-0.10, and 0.10-1. Finally, a one-sided goodness-of-fit test is performed on these binned frequencies to determine if they depart from an expected 5% p-values being below 0.05 (versus more than 5%), using the default test = :onesided. Alternatively, the option test = :goodness carries out the overall goodness-of-fit chi-square test proposed by Stenz et al. (2015), to test for any kind of departure from the expected frequencies (0.01, 0.04, 0.05, 0.90) across all 4 bins.\n\nThe first version takes a DataFrame where each row corresponds to a given four-taxon set. The data frame is modified by having an additional another column containing the outlier p-values corresponding to each four-taxon set.\nThe second version takes a DataCF object and modifies it by updating the expected concordance factors stored in that object.\nThe last version (which all others call) assumes that the expected concordance factors in the DataCF object are correctly calculated from the test network.\n\narguments\n\noptbl: when false, the loglik field of net is updated but branch lengths are taken as is. When true, a copy of net is used to conduce the test, with updated branch lengths (in coalescent units) and updated loglik. This network is returned.\nquartetstat = :maxCF: test statistic used to obtain an outlier p-value for each four-taxon set. By default, it is the absolute difference between the observed CF and expected CF of the major resolution (which has the largest CF) if quartetstat=:maxCF, as used in Stenz et al. (2015). The other option is quartetstat=:minpval, in which case the absolute difference between the observed CF and expected CF is calculated for all 3 resolutions, leading to 3 (non-independent) p-values. The outlier p-value for a given four-taxon set is taken as the minimum of these 3 p-values. This option can detect all kinds of departure from the network model for a given four-taxon set, but is not recommended because it is very liberal.\ntest = :onesided: the overall goodness-of-fit test performed on binned frequencies of quartet outlier p-values; see above.\n\noutput\n\np-value of the overall goodness-of-fit test\ntest statistic (z value)\na dictionary of the count of p-values in each of the four category\na vector of two test parameters for the Dirichlet distribution:\nvalue of the concentration parameter α\nvalue of the pseudo likelihood (optimized at α)\na vector of outlier p-values, one for each four-taxon set\nnetwork (first and second versions): net with loglik field updated if optbl is false;  copy of net with optimized branch lengths and loglik if optbl is true\n\nreferences\n\nNWM Stenz, B Larget, DA Baum and C Ané (2015). Exploring tree-like and non-tree-like patterns using genome sequences: An example using the inbreeding plant species Arabidopsis thaliana (L.) Heynh. Systematic Biology, 64(5):809-823. doi: 10.1093/sysbio/syv039\n\n\n\n\n\n","category":"method"},{"location":"lib/public/#QuartetNetworkGoodnessFit.quarnetGoFtest!-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool}","page":"public","title":"QuartetNetworkGoodnessFit.quarnetGoFtest!","text":"quarnetGoFtest!(net::HybridNetwork, df::DataFrame, optbl::Bool; quartetstat])\nquarnetGoFtest!(net::HybridNetwork, dcf::DataCF,   optbl::Bool; quartetstat])\nquarnetGoFtest(dcf::DataCF, quartetstat::Symbol)\n\nGoodness-of-fit test for the adequacy of the multispecies network coalescent, to see if a given population or species network explains the quartet concordance factor data adequately. The network needs to be of level 1 at most (trees fullfil this condition), and have branch lengths in coalescent units. The test assumes a multinomial distribution for the observed quartet concordance factors (CF), such that information on the number of genes for each four-taxon set (ngenes field) must be present.\n\nFor each four-taxon set, an outlier p-value is obtained by comparing a test statistic (-2log likelihood ratio by default) to a chi-square distribution with 2 degrees of freedom (see below for other options).\n\nThe four-taxon sets are then binned into categories according to their outlier p-values: 0-0.01, 0.01-0.05, 0.05-0.10, and 0.10-1. Finally, a one-sided goodness-of-fit test is performed on these binned frequencies to determine if they depart from an expected 5% p-values being below 0.05 (versus more than 5%).\n\nThe first version takes a DataFrame where each row corresponds to a given four-taxon set. The data frame is modified by having an additional another column containing the p-values corresponding to each four-taxon set.\nThe second version takes a DataCF object and modifies it by updating the expected concordance factors stored in that object.\nThe last version (which all others call) assumes that the expected concordance factors in the DataCF object are correctly calculated from the test network.\n\narguments\n\noptbl: when false, net.loglik is updated but branch lengths are taken as is. When true, a copy of net is used to conduce the test, with optimized branch lengths (in coalescent units) and updated loglik. This network is returned.\nquartetstat: the test statistic used to obtain an outlier p-value for each four-taxon set, which is then compared to a chi-squared distribution with 2 degrees of freedom to get a p-value. The default is :LRT for the likelihood ratio: 2n_genes sum_j=1^3 hat p_j (loghat p_j - log p_j) where p_j is the quartet CF expected from the network, and hat p_j is the quartet CF observed in the data.   Alternatives are :Qlog for the Qlog statistics (Lorenzen, 1995): 2n_genes sum_j=1^3 frac(hat p_j - p_j)^2p_j (loghat p_j - log p_j)   and :pearson for Pearon's chi-squared statistic, which behaves poorly when the expected count is low (e.g. less than 5): n_genes sum_j=1^3 frac(hat p_j - p_j)^2 p_j\n\noutput\n\np-value of the overall goodness-of-fit test\ntest statistic (z value)\na dictionary of the count of p-values in each of the four category\na vector of outlier p-values, one for each four-taxon set\nnetwork (first and second versions): net with loglik field updated if optbl is false;  copy of net with optimized branch lengths and loglik if optbl is true\n\nSee also: ticr!.\n\nreferences\n\nLorenzen (1995). A new family of goodness-of-fit statistics for discrete multivariate data. Statistics & Probability Letters, 25(4):301-307. doi: 10.1016/0167-7152(94)00234-8\n\n\n\n\n\n","category":"method"},{"location":"#QuartetNetworkGoodnessFit.jl-1","page":"home","title":"QuartetNetworkGoodnessFit.jl","text":"","category":"section"},{"location":"#","page":"home","title":"home","text":"Julia package to measure the goodness of fit of a phylogenetic network to data on subsets of 4 tips. It depends on the PhyloNetworks package.","category":"page"},{"location":"#","page":"home","title":"home","text":"Pages = [\"lib/public.md\", \"lib/internals.md\"]\nDepth = 1","category":"page"},{"location":"#functions-1","page":"home","title":"functions","text":"","category":"section"},{"location":"#","page":"home","title":"home","text":"Pages = [\"lib/public.md\", \"lib/internals.md\"]\nOrder = [:function]","category":"page"},{"location":"lib/internal/#internal-documentation-1","page":"internal","title":"internal documentation","text":"","category":"section"},{"location":"lib/internal/#","page":"internal","title":"internal","text":"Documentation for QuartetNetworkGoodnessFit's internal functions. Those functions are not exported, but can still be used (like: QuartetNetworkGoodnessFit.foo() for a function named foo()).","category":"page"},{"location":"lib/internal/#index-1","page":"internal","title":"index","text":"","category":"section"},{"location":"lib/internal/#","page":"internal","title":"internal","text":"Pages = [\"internals.md\"]","category":"page"},{"location":"lib/internal/#functions-1","page":"internal","title":"functions","text":"","category":"section"},{"location":"lib/internal/#","page":"internal","title":"internal","text":"Modules = [QuartetNetworkGoodnessFit]\nPublic  = false\nOrder   = [:function]","category":"page"},{"location":"lib/internal/#QuartetNetworkGoodnessFit.dirichlet_max-Tuple{PhyloNetworks.DataCF}","page":"internal","title":"QuartetNetworkGoodnessFit.dirichlet_max","text":"dirichlet_max(dcf::DataCF)\n\nCalculate outlier p-values, one for each four-taxon set, using the maximum concordance factor under a Dirichlet distribution. Used by ticr!.\n\noutput\n\nvector of outlier p-values, one for each 4-taxon set\nvalue of the concentration parameter α\nvalue of the pseudo likelihood (optimized at α)\n\n\n\n\n\n","category":"method"},{"location":"lib/internal/#QuartetNetworkGoodnessFit.dirichlet_min-Tuple{PhyloNetworks.DataCF}","page":"internal","title":"QuartetNetworkGoodnessFit.dirichlet_min","text":"dirichlet_min(dcf::DataCF)\n\nFirst calculate outlier p-values using each of the three concordance factors for each quartet under a Dirichlet distribution, then take the smallest p-value among the three, as the outlier p-value for each four-taxon set.\n\noutput\n\na vector of outlier p-values, one for each quartet\nvalue of the concentration parameter α\nvalue of the pseudo likelihood (optimized at α)\n\n\n\n\n\n","category":"method"},{"location":"lib/internal/#QuartetNetworkGoodnessFit.multinom_lrt-Tuple{PhyloNetworks.DataCF}","page":"internal","title":"QuartetNetworkGoodnessFit.multinom_lrt","text":"multinom_lrt(dcf::DataCF)\nmultinom_lrt(quartet::Vector{Quartet})\n\nCalculate the vector of outlier p-values (one per four-taxon set) using the likelihood ratio test under a multinomial distribution for the observed concordance factors.\n\n\n\n\n\n","category":"method"},{"location":"lib/internal/#QuartetNetworkGoodnessFit.multinom_pearson-Tuple{PhyloNetworks.DataCF}","page":"internal","title":"QuartetNetworkGoodnessFit.multinom_pearson","text":"multinom_pearson(dcf::DataCF)\nmultinom_pearson(quartet::Vector{Quartet})\n\nCalculate the vector of outlier p-values (one per four-taxon set) using Pearson's chi-squared statistic under a multinomial distribution for the observed concordance factors.\n\n\n\n\n\n","category":"method"},{"location":"lib/internal/#QuartetNetworkGoodnessFit.multinom_qlog-Tuple{PhyloNetworks.DataCF}","page":"internal","title":"QuartetNetworkGoodnessFit.multinom_qlog","text":"multinom_qlog(dcf::DataCF)\nmultinom_qlog(quartet::Vector{Quartet})\n\nCalculate the vector of outlier p-values (one per four-taxon set) using the Qlog statistic (Lorenzen, 1995), under a multinomial distribution for the observed concordance factors.\n\n\n\n\n\n","category":"method"},{"location":"lib/internal/#QuartetNetworkGoodnessFit.ticr_optimalpha-Tuple{PhyloNetworks.DataCF}","page":"internal","title":"QuartetNetworkGoodnessFit.ticr_optimalpha","text":"ticr_optimalpha(dcf::DataCF)\n\nFind the concentration parameter α by maximizing the pseudo-log-likelihood of observed quartet concordance factors. The model assumes a Dirichlet distribution with mean equal to the expected concordance factors calculated from a phylogenetic network (under ILS). These expected CFs are assumed to be already calculated, and stored in dcf.\n\nWhen calculating the pseudo-log-likelihood, this function checks the observed concordance factors for any values equal to zero: they cause a problem because the Dirichlet density is 0 at 0 (for concentration α > 1). Those 0.0 observed CF values are re-set to the minimum of:\n\nthe minimum of all expected concordance factors, and\nthe minimum of all nonzero observed concordance factors.\n\noutput\n\nmaximized pseudo-loglikelihood\nvalue of α where the pseudo-loglikelihood is maximized\nreturn code of the optimization\n\nThe optimization uses NLOpt, with the :LN_BOBYQA method. Optional arguments can tune the optimization differently: nloptmethod, xtol_rel (1e-6 by default), starting α value x_start (1.0 by default).\n\n\n\n\n\n","category":"method"}]
}
